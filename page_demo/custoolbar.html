<html>
<head>
<title>自定义浏览页面</title>
<script type="text/javascript">
   function afterload(){
   var contentPane = document.getElementById("reportFrame").contentWindow.contentPane;
   contentPane.on("afterload", function(){ 
       var cPageIndex = contentPane.currentPageIndex; 
       var pv = "第" + cPageIndex + "页/共" + contentPane.reportTotalPage + "页"; 
       document.getElementById("a").value = pv;
    }); 
   }
</script>
</head>
<body onload="afterload()">
<div id="toolbar">
<button type="button" onclick="document.getElementById('reportFrame').contentWindow.contentPane.gotoFirstPage()">首页</button>
<button type="button" onclick="document.getElementById('reportFrame').contentWindow.contentPane.gotoPreviousPage()">上一页</button>  
<input id="a"  type="text" readonly="true" style="width:80px">
<button type="button" onclick="document.getElementById('reportFrame').contentWindow.contentPane.gotoNextPage()">下一页</button>    
<button type="button" onclick="document.getElementById('reportFrame').contentWindow.contentPane.gotoLastPage()">末页</button>    
<button type="button" onclick="document.getElementById('reportFrame').contentWindow.contentPane.pdfPrint()">客户端PDF打印</button>
<button type="button" onclick="document.getElementById('reportFrame').contentWindow.contentPane.flashPrint()">客户端FLASH打印</button>
<button type="button" onclick="document.getElementById('reportFrame').contentWindow.contentPane.appletPrint()">Applet打印</button> 
<button type="button" onclick="document.getElementById('reportFrame').contentWindow.contentPane.printReportServer()">服务器打印</button>    
<button type="button" onclick="document.getElementById('reportFrame').contentWindow.contentPane.exportReportToPDF()">导出[PDF]</button>    
<button type="button" onclick="document.getElementById('reportFrame').contentWindow.contentPane.exportReportToExcel('page')">导出[Excel](分页)</button>
<button type="button" onclick="document.getElementById('reportFrame').contentWindow.contentPane.exportReportToExcel('simple')">导出[Excel](原样)</button>
<button type="button" onclick="document.getElementById('reportFrame').contentWindow.contentPane.exportReportToExcel('sheet')">导出[Excel](分页分Sheet)</button>
<button type="button" onclick="document.getElementById('reportFrame').contentWindow.contentPane.exportReportToWord()">导出[Word]</button>    
<button type="button" onclick="document.getElementById('reportFrame').contentWindow.contentPane.emailReport()">邮件</button>
</div>
<iframe id="reportFrame" src="/WebReport/ReportServer?reportlet=/gettingstarted.cpt&__showtoolbar__=false" width = 100% height = 80%></iframe>
</body>
</html>


